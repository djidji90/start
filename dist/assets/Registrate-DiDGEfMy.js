import{y as Q,j as e,a as ee,g as re,r as p,u as te,q as ce,V as me,f as E,s as N,p as _,h as se,X as he,Y as xe,m as U,v as q,Z as K,_ as be,A as $,$ as W,b as ge,a0 as oe,R as de,I as fe,J as ve,z as ye,K as f,a1 as Ce,G as Y,H as ne}from"./index-C7bfEiFr.js";import{P as F,D as ae,a as je,b as le,c as we}from"./DialogTitle-KkI_10Mp.js";import{a as ke,A as Pe}from"./index-COPrfliv.js";import{u as Se}from"./useConfig-CN1-DwZd.js";import{b as Re,T as j}from"./TextField-DIqtkQAg.js";import{I as X,V as Le,a as Fe}from"./VisibilityOff-BJEwgB1c.js";const $e=Q(e.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Te=Q(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Ie=Q(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Be(r){return re("MuiCheckbox",r)}const J=ee("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Me=r=>{const{classes:t,indeterminate:n,color:s,size:h}=r,o={root:["root",n&&"indeterminate",`color${_(s)}`,`size${_(h)}`]},d=se(o,Be,t);return{...t,...d}},_e=N(he,{shouldForwardProp:r=>xe(r)||r==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(r,t)=>{const{ownerState:n}=r;return[t.root,n.indeterminate&&t.indeterminate,t[`size${_(n.size)}`],n.color!=="default"&&t[`color${_(n.color)}`]]}})(U(({theme:r})=>({color:(r.vars||r).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:q(r.palette.action.active,r.palette.action.hoverOpacity)}}},...Object.entries(r.palette).filter(K()).map(([t])=>({props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette[t].mainChannel} / ${r.vars.palette.action.hoverOpacity})`:q(r.palette[t].main,r.palette.action.hoverOpacity)}}})),...Object.entries(r.palette).filter(K()).map(([t])=>({props:{color:t},style:{[`&.${J.checked}, &.${J.indeterminate}`]:{color:(r.vars||r).palette[t].main},[`&.${J.disabled}`]:{color:(r.vars||r).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),De=e.jsx(Te,{}),Ae=e.jsx($e,{}),Oe=e.jsx(Ie,{}),qe=p.forwardRef(function(t,n){const s=te({props:t,name:"MuiCheckbox"}),{checkedIcon:h=De,color:o="primary",icon:d=Ae,indeterminate:c=!1,indeterminateIcon:w=Oe,inputProps:T,size:I="medium",disableRipple:S=!1,className:k,slots:P={},slotProps:B={},...M}=s,R=c?w:d,C=c?w:h,L={...s,disableRipple:S,color:o,indeterminate:c,size:I},b=Me(L),y=B.input??T,[u,x]=ce("root",{ref:n,elementType:_e,className:E(b.root,k),shouldForwardComponentProp:!0,externalForwardedProps:{slots:P,slotProps:B,...M},ownerState:L,additionalProps:{type:"checkbox",icon:p.cloneElement(R,{fontSize:R.props.fontSize??I}),checkedIcon:p.cloneElement(C,{fontSize:C.props.fontSize??I}),disableRipple:S,slots:P,slotProps:{input:me(typeof y=="function"?y(L):y,{"data-indeterminate":c})}}});return e.jsx(u,{...x,classes:b})});function ze(r){return re("MuiFormControlLabel",r)}const z=ee("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Ve=r=>{const{classes:t,disabled:n,labelPlacement:s,error:h,required:o}=r,d={root:["root",n&&"disabled",`labelPlacement${_(s)}`,h&&"error",o&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",h&&"error"]};return se(d,ze,t)},We=N("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(r,t)=>{const{ownerState:n}=r;return[{[`& .${z.label}`]:t.label},t.root,t[`labelPlacement${_(n.labelPlacement)}`]]}})(U(({theme:r})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${z.disabled}`]:{cursor:"default"},[`& .${z.label}`]:{[`&.${z.disabled}`]:{color:(r.vars||r).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:t})=>t==="start"||t==="top"||t==="bottom",style:{marginLeft:16}}]}))),Ee=N("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(r,t)=>t.asterisk})(U(({theme:r})=>({[`&.${z.error}`]:{color:(r.vars||r).palette.error.main}}))),Ne=p.forwardRef(function(t,n){const s=te({props:t,name:"MuiFormControlLabel"}),{checked:h,className:o,componentsProps:d={},control:c,disabled:w,disableTypography:T,inputRef:I,label:S,labelPlacement:k="end",name:P,onChange:B,required:M,slots:R={},slotProps:C={},value:L,...b}=s,y=be(),u=w??c.props.disabled??(y==null?void 0:y.disabled),x=M??c.props.required,V={disabled:u,required:x};["checked","name","onChange","value","inputRef"].forEach(g=>{typeof c.props[g]>"u"&&typeof s[g]<"u"&&(V[g]=s[g])});const H=Re({props:s,muiFormControl:y,states:["error"]}),D={...s,disabled:u,labelPlacement:k,required:x,error:H.error},m=Ve(D),a={slots:R,slotProps:{...d,...C}},[v,l]=ce("typography",{elementType:$,externalForwardedProps:a,ownerState:D});let i=S;return i!=null&&i.type!==$&&!T&&(i=e.jsx(v,{component:"span",...l,className:E(m.label,l==null?void 0:l.className),children:i})),e.jsxs(We,{className:E(m.root,o),ownerState:D,ref:n,...b,children:[p.cloneElement(c,V),x?e.jsxs("div",{children:[i,e.jsxs(Ee,{ownerState:D,"aria-hidden":!0,className:m.asterisk,children:[" ","*"]})]}):i]})});function Ue(r){return re("MuiLink",r)}const He=ee("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),Ge=({theme:r,ownerState:t})=>{const n=t.color,s=W(r,`palette.${n}.main`,!1)||W(r,`palette.${n}`,!1)||t.color,h=W(r,`palette.${n}.mainChannel`)||W(r,`palette.${n}Channel`);return"vars"in r&&h?`rgba(${h} / 0.4)`:q(s,.4)},ie={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Ye=r=>{const{classes:t,component:n,focusVisible:s,underline:h}=r,o={root:["root",`underline${_(h)}`,n==="button"&&"button",s&&"focusVisible"]};return se(o,Ue,t)},Je=N($,{name:"MuiLink",slot:"Root",overridesResolver:(r,t)=>{const{ownerState:n}=r;return[t.root,t[`underline${_(n.underline)}`],n.component==="button"&&t.button]}})(U(({theme:r})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:t,ownerState:n})=>t==="always"&&n.color!=="inherit",style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(r.palette).filter(K()).map(([t])=>({props:{underline:"always",color:t},style:{"--Link-underlineColor":r.vars?`rgba(${r.vars.palette[t].mainChannel} / 0.4)`:q(r.palette[t].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":r.vars?`rgba(${r.vars.palette.text.primaryChannel} / 0.4)`:q(r.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":r.vars?`rgba(${r.vars.palette.text.secondaryChannel} / 0.4)`:q(r.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(r.vars||r).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${He.focusVisible}`]:{outline:"auto"}}}]}))),Ke=p.forwardRef(function(t,n){const s=te({props:t,name:"MuiLink"}),h=ge(),{className:o,color:d="primary",component:c="a",onBlur:w,onFocus:T,TypographyClasses:I,underline:S="always",variant:k="inherit",sx:P,...B}=s,[M,R]=p.useState(!1),C=u=>{oe(u.target)||R(!1),w&&w(u)},L=u=>{oe(u.target)&&R(!0),T&&T(u)},b={...s,color:d,component:c,focusVisible:M,underline:S,variant:k},y=Ye(b);return e.jsx(Je,{color:d,className:E(y.root,o),classes:I,component:c,onBlur:C,onFocus:L,ref:n,ownerState:b,variant:k,...B,sx:[...ie[d]===void 0?[{color:d}]:[],...Array.isArray(P)?P:[P]],style:{...B.style,...S==="always"&&d!=="inherit"&&!ie[d]&&{"--Link-underlineColor":Ge({theme:h,ownerState:b})}}})}),Z=de.memo(({name:r,label:t,value:n,onChange:s,show:h,toggleShow:o,error:d,helperText:c})=>e.jsx(j,{fullWidth:!0,label:t,name:r,type:h?"text":"password",value:n,onChange:s,error:!!d,helperText:typeof c=="string"?c:"",InputProps:{endAdornment:e.jsx(X,{position:"end",children:e.jsx(fe,{onClick:o,edge:"end","aria-label":"toggle-password",children:h?e.jsx(Le,{}):e.jsx(Fe,{})})})}}));Z.propTypes={name:F.string.isRequired,label:F.string.isRequired,value:F.string.isRequired,onChange:F.func.isRequired,show:F.bool.isRequired,toggleShow:F.func.isRequired,error:F.string,helperText:F.string};const Xe=[{value:"M",label:"Masculino"},{value:"F",label:"Femenino"},{value:"O",label:"Otro"}],ue=()=>{const r=ve(),{api:t}=Se(),n=p.useRef(null),[s,h]=p.useState({username:"",email:"",password:"",password2:"",first_name:"",last_name:"",city:"",neighborhood:"",phone:"",gender:"",birth_date:"",country:"",terms_accepted:!1}),[o,d]=p.useState({}),[c,w]=p.useState({}),[T,I]=p.useState(""),[S,k]=p.useState(!1),[P,B]=p.useState(!1),[M,R]=p.useState(!1),[C,L]=p.useState(!1),b=p.useCallback((m,a)=>{const l={username:{required:!0,maxLength:150,validate:i=>/^[\w.@+-]+$/.test(i),message:"Solo letras, dígitos y @/./+/-/_"},email:{required:!0,maxLength:254,validate:i=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i),message:"Correo electrónico inválido"},password:{required:!0,minLength:8,validate:i=>i.length>=8,message:"Mínimo 8 caracteres"},password2:{required:!0,validate:(i,g)=>i===g.password,message:"Las contraseñas no coinciden"},phone:{validate:i=>!i||/^\+?\d{10,15}$/.test(i),message:"Formato inválido (ej: +5491123456789)"},birth_date:{validate:i=>!i||!isNaN(new Date(i).getTime()),message:"Fecha inválida"},terms_accepted:{required:!0,validate:i=>i===!0,message:"Debes aceptar los términos"}}[m];return l?l.required&&!a&&a!==!1?"Este campo es requerido":l.minLength&&a.length<l.minLength?`Mínimo ${l.minLength} caracteres`:l.maxLength&&a.length>l.maxLength?`Máximo ${l.maxLength} caracteres`:l.validate&&!l.validate(a,s)?l.message||"Valor no válido":null:null},[s]),y=p.useCallback(()=>{const m=["username","email","password","password2","terms_accepted"],a={},v={};return m.forEach(l=>{v[l]=!0,a[l]=b(l,s[l])}),w(v),d(a),Object.values(a).every(l=>l===null)},[s,b]),u=p.useCallback(m=>{const{name:a,value:v,type:l,checked:i}=m.target;let g=l==="checkbox"?i:v;a==="phone"&&(g=g.replace(/[^\d+]/g,"")),h(A=>({...A,[a]:g})),o[a]&&d(A=>({...A,[a]:null})),c[a]&&d(A=>({...A,[a]:b(a,g)}))},[c,b,o]),x=p.useCallback(m=>{const{name:a}=m.target;w(v=>({...v,[a]:!0})),d(v=>({...v,[a]:b(a,s[a])}))},[s,b]),V=p.useCallback(async m=>{var a,v;if(m.preventDefault(),!y()){d(l=>({...l,general:"Por favor corrige los errores en el formulario"}));return}L(!0);try{const l=await ke.post(`${t.baseURL}/api/register/`,s);I("¡Registro exitoso! Redirigiendo..."),k(!0),d({}),h({username:"",email:"",password:"",password2:"",first_name:"",last_name:"",city:"",neighborhood:"",phone:"",gender:"",birth_date:"",country:"",terms_accepted:!1}),setTimeout(()=>r("/"),3e3)}catch(l){const i=((a=l.response)==null?void 0:a.data)||{};if(i.errors){const g={};Object.entries(i.errors).forEach(([pe,G])=>{g[pe]=Array.isArray(G)?G[0]:G}),d(g),Object.keys(g)[0]==="username"&&((v=n.current)==null||v.focus())}else d({general:i.message||"Error en el servidor. Intente nuevamente."})}finally{L(!1)}},[t.baseURL,s,r,y]),H=({error:m,touched:a})=>!m||!a?null:e.jsx($,{variant:"caption",color:"error",sx:{display:"block",mt:.5},children:m}),D=p.useMemo(()=>["username","email","password","password2","terms_accepted"].every(a=>!b(a,s[a])),[s,b]);return e.jsxs(ye,{sx:O.container,children:[e.jsx($,{variant:"h4",sx:O.title,children:"Registro de Usuario"}),o.general&&e.jsx(Pe,{severity:"error",sx:O.alert,children:o.general}),e.jsx("form",{onSubmit:V,children:e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(j,{fullWidth:!0,inputRef:n,label:e.jsxs(e.Fragment,{children:["Nombre de Usuario",e.jsx("span",{style:{color:"red"},children:"*"})]}),name:"username",value:s.username,onChange:u,onBlur:x,error:!!o.username&&(c.username||!!o.username),helperText:(c.username||!!o.username)&&o.username,InputProps:{endAdornment:e.jsx(X,{position:"end",children:e.jsxs($,{variant:"caption",color:"textSecondary",children:[s.username.length,"/150"]})})}})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(j,{fullWidth:!0,label:e.jsxs(e.Fragment,{children:["Correo Electrónico",e.jsx("span",{style:{color:"red"},children:"*"})]}),name:"email",type:"email",value:s.email,onChange:u,onBlur:x,error:!!o.email&&(c.email||!!o.email),helperText:(c.email||!!o.email)&&o.email,InputProps:{endAdornment:e.jsx(X,{position:"end",children:e.jsxs($,{variant:"caption",color:"textSecondary",children:[s.email.length,"/254"]})})}})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(j,{fullWidth:!0,label:"Nombre (Opcional)",name:"first_name",value:s.first_name,onChange:u,onBlur:x,error:!!o.first_name,helperText:o.first_name})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(j,{fullWidth:!0,label:"Apellido (Opcional)",name:"last_name",value:s.last_name,onChange:u,onBlur:x,error:!!o.last_name,helperText:o.last_name})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(j,{fullWidth:!0,label:"Teléfono (Opcional)",name:"phone",value:s.phone,onChange:u,onBlur:x,placeholder:"+5491123456789",error:!!o.phone,helperText:o.phone})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(j,{select:!0,fullWidth:!0,label:"Género (Opcional)",name:"gender",value:s.gender,onChange:u,onBlur:x,children:Xe.map(m=>e.jsx(Ce,{value:m.value,children:m.label},m.value))})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(j,{fullWidth:!0,label:"Fecha de Nacimiento (Opcional)",name:"birth_date",type:"date",value:s.birth_date,onChange:u,onBlur:x,InputLabelProps:{shrink:!0}})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(j,{fullWidth:!0,label:"Ciudad (Opcional)",name:"city",value:s.city,onChange:u,onBlur:x})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(j,{fullWidth:!0,label:"Barrio (Opcional)",name:"neighborhood",value:s.neighborhood,onChange:u,onBlur:x})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(j,{fullWidth:!0,label:"País (Opcional)",name:"country",value:s.country,onChange:u,onBlur:x})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(Z,{name:"password",label:e.jsxs(e.Fragment,{children:["Contraseña",e.jsx("span",{style:{color:"red"},children:"*"})]}),value:s.password,onChange:u,onBlur:x,show:P,toggleShow:()=>B(!P),error:!!o.password&&(c.password||!!o.password),helperText:c.password||o.password?o.password||"Mínimo 8 caracteres":""})}),e.jsx(f,{item:!0,xs:12,sm:6,children:e.jsx(Z,{name:"password2",label:e.jsxs(e.Fragment,{children:["Confirmar Contraseña",e.jsx("span",{style:{color:"red"},children:"*"})]}),value:s.password2,onChange:u,onBlur:x,show:M,toggleShow:()=>R(!M),error:!!o.password2&&(c.password2||!!o.password2),helperText:(c.password2||!!o.password2)&&o.password2})}),e.jsxs(f,{item:!0,xs:12,children:[e.jsx(Ne,{control:e.jsx(qe,{checked:s.terms_accepted,onChange:u,onBlur:x,name:"terms_accepted",color:"primary"}),label:e.jsxs("span",{children:["Acepto los"," ",e.jsx(Ke,{href:"/terms",color:"primary",children:"términos y condiciones"}),e.jsx("span",{style:{color:"red"},children:"*"})]})}),e.jsx(H,{error:o.terms_accepted,touched:c.terms_accepted})]}),e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{type:"submit",fullWidth:!0,variant:"contained",disabled:C||!D,sx:O.button,startIcon:C&&e.jsx(ne,{size:20}),children:C?"Registrando...":"Registrarse"})})]})}),e.jsxs($,{sx:O.loginText,children:["¿Ya tienes cuenta?"," ",e.jsx(Y,{onClick:()=>r("/"),sx:O.loginLink,children:"Iniciar sesión"})]}),e.jsxs(ae,{open:S,onClose:()=>k(!1),disablePortal:!0,children:[e.jsx(je,{children:"¡Registro Exitoso!"}),e.jsx(le,{children:T}),e.jsx(we,{children:e.jsx(Y,{onClick:()=>{k(!1),r("/")},color:"primary",children:"Ir a Login"})})]}),e.jsx(ae,{open:C,disablePortal:!0,children:e.jsxs(le,{sx:{textAlign:"center",p:4},children:[e.jsx(ne,{}),e.jsx($,{variant:"h6",sx:{mt:2},children:"Procesando registro..."})]})})]})},O={container:{maxWidth:"600px",margin:"auto",mt:5,p:3,borderRadius:2,boxShadow:3,bgcolor:"background.paper"},title:{textAlign:"center",mb:4,fontWeight:"bold",color:"primary.main"},alert:{mb:2},button:{py:1.5,fontWeight:"bold",fontSize:"1.1rem"},loginText:{textAlign:"center",mt:3,fontSize:"0.95rem"},loginLink:{textTransform:"none",fontWeight:"bold"}};ue.propTypes={navigate:F.func};const or=de.memo(ue);export{or as default};
