import{R as D,j as e,b as I,u as P,r as o,B as L,T as W,G as t,d as C,c as B}from"./index-DS7J-bX6.js";import{P as i,D as F,a as U,b as z}from"./DialogTitle-CN8NVrbV.js";import{a as M,A as N}from"./index-BRcMmfnR.js";import{u as O}from"./useConfig-CN1-DwZd.js";import{T as l}from"./TextField-CpSQQ_dF.js";import{I as V,V as G,a as $}from"./VisibilityOff-B2krXH_q.js";import{D as Y}from"./DialogActions-CqbzLWRL.js";import"./Select-BnqMfHL1.js";import"./useControlled-DFVkmYp8.js";const y=D.memo(({name:d,label:x,value:r,onChange:g,show:s,toggleShow:m,error:f,helperText:b})=>e.jsx(l,{fullWidth:!0,label:x,name:d,type:s?"text":"password",value:r,onChange:g,error:!!f,helperText:b,InputProps:{endAdornment:e.jsx(V,{position:"end",children:e.jsx(I,{onClick:m,edge:"end","aria-label":"toggle-password",children:s?e.jsx(G,{}):e.jsx($,{})})})}}));y.propTypes={name:i.string.isRequired,label:i.string.isRequired,value:i.string.isRequired,onChange:i.func.isRequired,show:i.bool.isRequired,toggleShow:i.func.isRequired,error:i.string,helperText:i.string};const _=()=>{const d=P(),{api:x}=O(),[r,g]=o.useState({username:"",email:"",password:"",password2:"",first_name:"",last_name:"",city:"",neighborhood:"",phone:""}),[s,m]=o.useState({}),[f,b]=o.useState(""),[k,j]=o.useState(!1),[T,q]=o.useState(!1),[v,A]=o.useState(!1),[w,R]=o.useState(!1),S=o.useCallback(()=>{const a={};return["username","email","password","password2","first_name","last_name"].forEach(c=>{r[c]||(a[c]="Este campo es requerido")}),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)||(a.email="Correo electrónico inválido"),r.password!==r.password2&&(a.password2="Las contraseñas no coinciden"),/(?=.*[A-Z])(?=.*\d).{8,}/.test(r.password)||(a.password="Mínimo 8 caracteres, 1 mayúscula y 1 número"),m(a),Object.keys(a).length===0},[r]),n=o.useCallback(a=>{const{name:u,value:c}=a.target;g(h=>({...h,[u]:c})),m(h=>({...h,[u]:""}))},[]),E=o.useCallback(async a=>{var u;if(a.preventDefault(),!!S()){R(!0),m({});try{await M.post(`${x.baseURL}/api/register/`,r),b("¡Registro exitoso! Redirigiendo..."),j(!0),setTimeout(()=>{j(!1),d("/")},3e3)}catch(c){const h=((u=c.response)==null?void 0:u.data)||{};m({general:"Error en el registro",...h.errors,...h})}finally{R(!1)}}},[x.baseURL,r,d,S]);return e.jsxs(L,{sx:p.container,children:[e.jsx(W,{variant:"h4",sx:p.title,children:"Registro de Usuario"}),s.general&&e.jsx(N,{severity:"error",sx:p.alert,children:s.general}),e.jsx("form",{onSubmit:E,children:e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(l,{fullWidth:!0,label:"Nombre de Usuario",name:"username",value:r.username,onChange:n,error:!!s.username,helperText:s.username})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(l,{fullWidth:!0,label:"Correo Electrónico",name:"email",type:"email",value:r.email,onChange:n,error:!!s.email,helperText:s.email})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(l,{fullWidth:!0,label:"Nombre",name:"first_name",value:r.first_name,onChange:n,error:!!s.first_name,helperText:s.first_name})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(l,{fullWidth:!0,label:"Apellido",name:"last_name",value:r.last_name,onChange:n,error:!!s.last_name,helperText:s.last_name})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(l,{fullWidth:!0,label:"Ciudad",name:"city",value:r.city,onChange:n,error:!!s.city,helperText:s.city})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(l,{fullWidth:!0,label:"Barrio",name:"neighborhood",value:r.neighborhood,onChange:n,error:!!s.neighborhood,helperText:s.neighborhood})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(l,{fullWidth:!0,label:"Teléfono",name:"phone",value:r.phone,onChange:n,error:!!s.phone,helperText:s.phone,placeholder:"+5491123456789"})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(y,{name:"password",label:"Contraseña",value:r.password,onChange:n,show:T,toggleShow:()=>q(!T),error:s.password,helperText:s.password})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(y,{name:"password2",label:"Confirmar Contraseña",value:r.password2,onChange:n,show:v,toggleShow:()=>A(!v),error:s.password2,helperText:s.password2})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(C,{type:"submit",fullWidth:!0,variant:"contained",disabled:w,sx:p.button,startIcon:w&&e.jsx(B,{size:20}),children:w?"Registrando...":"Registrarse"})})]})}),e.jsxs(W,{sx:p.loginText,children:["¿Ya tienes cuenta?"," ",e.jsx(C,{onClick:()=>d("/"),sx:p.loginLink,children:"Iniciar sesión"})]}),e.jsxs(F,{open:k,onClose:()=>j(!1),children:[e.jsx(U,{children:"¡Registro Exitoso!"}),e.jsx(z,{children:f}),e.jsx(Y,{children:e.jsx(C,{onClick:()=>d("/login"),color:"primary",children:"Ir a Login"})})]})]})},p={container:{maxWidth:"600px",margin:"auto",mt:5,p:3,borderRadius:2,boxShadow:3,bgcolor:"background.paper"},title:{textAlign:"center",mb:4,fontWeight:"bold",color:"primary.main"},alert:{mb:2},button:{py:1.5,fontWeight:"bold",fontSize:"1.1rem"},loginText:{textAlign:"center",mt:3,fontSize:"0.95rem"},loginLink:{textTransform:"none",fontWeight:"bold"}};_.propTypes={navigate:i.func};const te=D.memo(_);export{te as default};
