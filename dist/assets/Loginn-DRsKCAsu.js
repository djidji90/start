import{f as W,j as e,g as z,r as t,u as M,s as v,T as V,G as n,b as D,d as O,c as F,B as w,k as H}from"./index-DS7J-bX6.js";import{A as b,a as j}from"./index-BRcMmfnR.js";import{u as N}from"./useConfig-CN1-DwZd.js";import{T as y}from"./TextField-CpSQQ_dF.js";import{I as Y,V as $,a as G}from"./VisibilityOff-B2krXH_q.js";import{S as U}from"./Snackbar-BCITj4um.js";import"./Select-BnqMfHL1.js";import"./useControlled-DFVkmYp8.js";const q=W(e.jsx("path",{d:"M11 7 9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8z"}),"Login"),J=H`
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  `,K=v(w)(({theme:a})=>({background:a.palette.background.default,minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"})),Q=v(w)(({theme:a})=>({background:a.palette.background.paper,borderRadius:"16px",padding:a.spacing(4),width:"100%",maxWidth:"440px",boxShadow:a.shadows[3],animation:`${J} 0.6s ease-out`,transition:"transform 0.3s ease","&:hover":{transform:"translateY(-3px)"}})),oe=()=>{const a=z(),{api:S}=N(),[r,I]=t.useState({username:"",password:""}),[o,i]=t.useState({}),[k,u]=t.useState(""),[C,p]=t.useState(!1),[d,m]=t.useState(!1),[c,A]=t.useState(!1),[x,L]=t.useState(null),T=M(),P=async()=>{try{const s=await j.get("https://api64.ipify.org?format=json");L(s.data.ip)}catch(s){console.error("Error al obtener la IP del usuario:",s)}},h=s=>{I({...r,[s.target.name]:s.target.value})},R=()=>{const s={};return r.username.trim()||(s.username="Nombre de usuario requerido"),r.password||(s.password="La contrase침a es obligatoria"),i(s),Object.keys(s).length===0},B=async s=>{var g,f;if(s.preventDefault(),i({}),u(""),!!R()){m(!0);try{x||await P();const l=await j.post(`${S.baseURL}/api/api/token/`,{...r,ip:x});localStorage.setItem("accessToken",l.data.access),localStorage.setItem("username",r.username),u(`Bienvenido a djidji music, ${r.username}!`),p(!0),setTimeout(()=>T("/MainPage"),1500)}catch(l){const E=((f=(g=l.response)==null?void 0:g.data)==null?void 0:f.detail)||"Error de autenticaci칩n. Verifica tus credenciales";i({general:E})}finally{m(!1)}}};return e.jsx(K,{children:e.jsxs(Q,{children:[e.jsx(V,{variant:"h4",sx:{mb:4,fontWeight:700,color:a.palette.text.primary,textAlign:"center"},children:"Inicio de Sesi칩n"}),e.jsx("form",{onSubmit:B,children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,label:"Nombre de Usuario",name:"username",value:r.username,onChange:h,error:!!o.username,helperText:o.username,variant:"outlined",InputProps:{sx:{borderRadius:"8px"}}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,label:"Contrase침a",name:"password",type:c?"text":"password",value:r.password,onChange:h,error:!!o.password,helperText:o.password,variant:"outlined",InputProps:{endAdornment:e.jsx(Y,{position:"end",children:e.jsx(D,{onClick:()=>A(!c),edge:"end",children:c?e.jsx($,{}):e.jsx(G,{})})}),sx:{borderRadius:"8px"}}})}),o.general&&e.jsx(n,{item:!0,xs:12,children:e.jsx(b,{severity:"error",variant:"outlined",sx:{borderRadius:"8px",alignItems:"center"},children:o.general})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(O,{fullWidth:!0,type:"submit",variant:"contained",size:"large",disabled:d,startIcon:d?e.jsx(F,{size:24,color:"inherit"}):e.jsx(q,{}),sx:{py:1.5,borderRadius:"8px",fontWeight:600,backgroundColor:a.palette.primary.main,"&:hover":{backgroundColor:a.palette.primary.dark,boxShadow:a.shadows[2]},transition:"all 0.3s ease"},children:d?"Autenticando...":"Ingresar"})})]})}),e.jsx(U,{open:C,autoHideDuration:4e3,onClose:()=>p(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(b,{severity:"success",variant:"filled",sx:{borderRadius:"8px",boxShadow:a.shadows[2],alignItems:"center"},children:k})})]})})};export{oe as default};
